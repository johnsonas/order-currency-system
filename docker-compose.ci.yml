# CI 測試環境 Docker Compose
# 用於在 CI 中運行整合測試
version: '3.8'

services:
  # Oracle 資料庫（測試用）
  oracle-test:
    image: gvenzl/oracle-free:latest
    container_name: order-currency-oracle-test
    environment:
      ORACLE_PASSWORD: Oracle123
      ORACLE_DATABASE: FREEPDB1
    ports:
      - "1522:1521"  # 使用不同端口避免衝突
    healthcheck:
      test: ["CMD-SHELL", "sqlplus -s sys/Oracle123@FREEPDB1 as sysdba <<< 'SELECT 1 FROM DUAL;' || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 10
      start_period: 60s

  # Redis（測試用）
  redis-test:
    image: redis:7-alpine
    container_name: order-currency-redis-test
    ports:
      - "6380:6379"  # 使用不同端口避免衝突
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5


